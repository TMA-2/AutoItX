<!DOCTYPE html>
<html>
<head>
<title>Method ControlListView</title>
<meta charset="utf-8">
<link href="../../css/default.css" rel="stylesheet">
</head>

<body>
<h1 class="small">Method Reference</h1>
<hr style="height:0px">
<h1>ControlListView</h1>
<p class="funcdesc">Sends a command to a ListView32 control<br /></p>
<p class="codeheader">
ControlListView "title", "text", "controlID", "command", "option1", "option2"<br />
</p>

<h2>Parameters</h2>
<table>
<tr>
<td style="width:15%">title</td>
<td style="width:85%">The title of the window to access.</td>
</tr>
<tr>
<td>text</td>
<td>The text of the window to access.</td>
</tr>
<tr>
<td>controlID</td>
<td>The control to interact with. See <a href="../../intro/controls.htm">Controls</a>.</td>
</tr>
<tr>
<td>command</td>
<td>The command to send to the control (see below).</td>
</tr>
<tr>
<td>option1</td>
<td>Additional parameter required by some commands; use "" if parameter is not required.</td>
</tr>
<tr>
<td>option2</td>
<td>Additional parameter required by some commands; use "" if parameter is not required.</td>
</tr>
</table>

<h2>Return Value</h2>
Depends&nbsp;on command as table below shows. In case of an error (such as an invalid command or window/control could not be found) then @error is set to 1.<br />
<br />
<br />
All&nbsp;items/subitems are 0 based. This means that the first item/subitem in a list is 0, the second is 1, and so on.<br />
<br />
In&nbsp;a "Details" view of a ListView32 control, the &quot;item&quot; can be thought of as the &quot;row&quot; and the &quot;subitem&quot; as the &quot;column&quot;.<br />
<br />
<table>
<tr>
<td style="width:40%"><strong>Command, Option1, Option2</strong></td>
<td style="width:60%"><strong>Operation</strong></td>
</tr>
<tr>
<td>"DeSelect", From [, To]</td>
<td>Deselects one or more items.</td>
</tr>
<tr>
<td>"FindItem", "string to find" [, SubItem]</td>
<td>Returns the item index of the string. Returns -1 if the string is not found.</td>
</tr>
<tr>
<td>"GetItemCount"</td>
<td>Returns the number of list items.</td>
</tr>
<tr>
<td>"GetSelected" [, option]</td>
<td>Returns a string containing the item index of selected items. If option=0 (default) only the first selected item is returned. If option=1 then all the selected items are returned delimited by |, e.g: &quot;0|3|4|10&quot;. If no items are selected a blank "" string is returned.</td>
</tr>
<tr>
<td>"GetSelectedCount"</td>
<td>Returns the number of items that are selected.</td>
</tr>
<tr>
<td>"GetSubItemCount"</td>
<td>Returns the number of subitems.</td>
</tr>
<tr>
<td>"GetText", Item, SubItem</td>
<td>Returns the text of a given item/subitem.</td>
</tr>
<tr>
<td>"IsSelected", Item</td>
<td>Returns 1 if the item is selected, otherwise returns 0.</td>
</tr>
<tr>
<td>"Select", From [, To]</td>
<td>Selects one or more items.</td>
</tr>
<tr>
<td>"SelectAll"</td>
<td>Selects all items.</td>
</tr>
<tr>
<td>"SelectClear"</td>
<td>Clears the selection of all items.</td>
</tr>
<tr>
<td>"SelectInvert"</td>
<td>Inverts the current selection.</td>
</tr>
<tr>
<td>"ViewChange", "view"</td>
<td>Changes the current view. Valid views are "list", "details", "smallicons", "largeicons".</td>
</tr>
</table>

<h2>Related</h2>
<p><a href="ControlClick.htm">ControlClick</a>, <a href="ControlCommand.htm">ControlCommand</a>, <a href="ControlDisable.htm">ControlDisable</a>, <a href="ControlEnable.htm">ControlEnable</a>, <a href="ControlFocus.htm">ControlFocus</a>, <a href="ControlGetPosX.htm">ControlGetPosX</a>, <a href="ControlGetPosY.htm">ControlGetPosY</a>, <a href="ControlGetText.htm">ControlGetText</a>, <a href="ControlHide.htm">ControlHide</a>, <a href="ControlMove.htm">ControlMove</a>, <a href="ControlSetText.htm">ControlSetText</a>, <a href="ControlShow.htm">ControlShow</a>, <a href="ControlTreeView.htm">ControlTreeView</a>, <a href="StatusbarGetText.htm">StatusbarGetText</a>, <a href="WinGetClassList.htm">WinGetClassList</a>, <a href="WinMenuSelectItem.htm">WinMenuSelectItem</a></p>

<h2 class="bottom">Example</h2>
<script type="text/javascript">
if ((navigator.appName == "Microsoft Internet Explorer") && (parseInt(navigator.appVersion) >= 4)) // IE (4+) only
function copyToClipboard(section) {
if (window.clipboardData && clipboardData.setData) {
clipboardData.setData("text", section + "\r\n");
alert("Copied to clipboard");
}
}
</script>
<div class="codeSnippetContainer">
<br />
<div class="codeSnippetContainerCodeContainer">
<div class="codeSnippetToolBar">
<div class="codeSnippetToolBarText">
<script type="text/javascript">
if ((navigator.appName == "Microsoft Internet Explorer") && (parseInt(navigator.appVersion) >= 4)) // IE (4+) only
document.write('<a href="#" id="copy" onclick="copyToClipboard(document.getElementById(\'copytext1\').innerText)">Copy to clipboard<\/a>');
</script>
</div>
</div>
<div class="codeSnippetContainerCode" dir="ltr" id="copytext1">
<pre>
<span>Set oAutoIt = WScript.CreateObject("AutoItX3.Control")
oAutoIt.ControlListView "C:\Program Files\NSIS", "", "SysListView321", "SelectAll", "", ""
oAutoIt.ControlListView "C:\Program Files\NSIS", "", "SysListView321", "Deselect", "2", "5"
</span><br />
</pre>
</div>
</div>
</div>
</body>
</html>
